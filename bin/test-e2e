#!/bin/bash


NPM=$(npm bin)

cmd=${2:-run}
args=${@:3}
url=http://localhost:8112

# echo $cmd
# echo $args

yarn run tutor:test:server &

PID=$!

echo started server with PID=$PID

echo Waiting for server to become available on $url
$NPM/wait-on $url
echo Server is now available

yarn run tutor:test:e2e --all
TEST_STATUS=$?

pkill -P $PID

exit $TEST_STATUS
