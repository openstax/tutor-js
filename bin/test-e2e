#!/bin/bash


NPM=$(npm bin)

NOTIFY=8002
URL=http://localhost:$NOTIFY

# echo $cmd
# echo $args

echo starting webpack, will wait for $URL

yarn run tutor:test:e2e:fe --notify-port $NOTIFY &

PID=$!

echo started server with PID=$PID

echo Waiting for server to become available on $URL
$NPM/wait-on $URL
echo Server is now available

docker ps

curl -v http://localhost:3001/

yarn run tutor:test:e2e my-courses

# --all
TEST_STATUS=$?

pkill -P $PID

exit $TEST_STATUS
